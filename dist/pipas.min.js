var pipas=function(a){return new function(){var b={basePath:"",locale:null,history:{},uniqueStyles:[],map:[],aliases:{},toArray:function(b){var c=[];return void 0!=b&&null!=b&&("string"==typeof b?c.push(b):a.each(b,function(a,b){c.push(b)})),c},resolveList:function(a){var c,d=b.toArray(a),e=[],f={src:[]};for(var g in d)c=b.resolve(d[g]),c?e.push(c):f.src.push(d[g]);return e.push(f),e},resolve:function(a){return b.aliases.hasOwnProperty(a)&&(a=b.aliases[a]),b.map.hasOwnProperty(a)?b.map[a]:null},hasExtension:function(a,b){var c=a.indexOf("?");return c>=0&&(a=a.substring(0,c)),a.substring(a.length-b.length)==b}};this.basePath=function(a){return void 0!=a&&(b.basePath=a),b.basePath},this.define=function(a,c,d,e,f){if(b.map.hasOwnProperty(a))throw new Error("Can not override dependency '"+a+"'.");var g,h,i=b.toArray(e);for(g in i)if(h=i[g],b.aliases.hasOwnProperty(h)){if(b.aliases[h]!=a)throw new Error("Alias '"+h+"' already exist form '"+b.aliases[h]+"'")}else b.aliases[h]=a;var j=b.toArray(d);for(g in j)if(!b.resolve(j[g]))throw new Error("Required dependency '"+j[g]+"' has not been defined.");return b.map[a]={name:a,src:b.toArray(c),req:j,initCb:f},this},this.defineDefault=function(a,b){try{this.define(a,b)}catch(c){}},this.applyBasePath=function(a,b){var c=a.replace(/^\/|\/$/g,"");if(a!=c){if(void 0!=b)throw new Error("Path '"+a+"' must be relative type (without backslash on beginning)");return a}return pipas.basePath()+"/"+(void 0==b?"":b.replace(/^\/|\/$/g,"")+"/")+c},this.applyBasePathForList=function(c,d){if(!c)throw new Error("url is not defined. Expected string or array");var e=[];return a.each(b.toArray(c),function(a,b){var c=b.replace(/^\/|\/$/g,"");if(b!=c){if(void 0!=d)throw new Error("Path '"+b+"' must be relative type (without backslash on beginning)");e[a]=b}else e[a]=pipas.basePath()+"/"+(void 0==d?"":d.replace(/^\/|\/$/g,"")+"/")+c}),e},this.locale=function(a){return void 0!=a&&(b.locale=a),b.locale||navigator.language||navigator.userLanguage},this.getUniqueStyle=function(c){var d=document.getElementsByTagName("head")[0];for(var e in b.uniqueStyles)d.removeChild(b.uniqueStyles[e]);b.uniqueStyles=[],a.each(this.applyBasePathForList(c),function(a,c){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=c,e.media="all",b.uniqueStyles[c]=e,d.appendChild(e)})},this.getDependencies=function(c,d,e,f){var g,h=[],i=[];a.each(c,function(c,d){if(b.history.hasOwnProperty(d))h.push(b.history[d]),b.history[d].readyState&&i.push(b.history[d]);else if(b.hasExtension(d,"js"))g=a.getScript(d),h.push(g),i.push(g),b.history[d]=g;else if(b.hasExtension(d,"css")){var e=a.Deferred();a(document.createElement("link")).attr({href:d,type:"text/css",rel:"stylesheet"}).appendTo("head").on("load",function(){e.resolve("and")}),h.push(e),b.history[d]=e}else g=a.get(d),h.push(g),i.push(g),b.history[d]=g}),a.when.apply(a,h).done(function(){d.apply(e,i)}).fail(function(){console.error("Cannot load dependencies: ",f?f:c,"Failing report: ",arguments,"Check if is correctly defined dependency via pipas.define()")})},this.get=function(a,c,d){var e,f,g=b.resolveList(a),h=[],i=[];for(e in g){for(f in g[e].src)h.push(this.applyBasePath(g[e].src[f]));for(f in g[e].req)i.push(g[e].req[f])}var j=function(){for(e in g){var a=g[e].initCb;"function"==typeof a&&(g[e].initCb.apply(d,arguments),g[e].initCb=null)}c&&c.apply(d,arguments)};i.length>0?this.get(i,function(){this.getDependencies(h,j,d,a)},this):this.getDependencies(h,j,d,a)},this.require=this.get}}(jQuery);!function(a,b){b.overlay=new function(){var b={defaultElement:a("<div>"),parents:[],getSelector:function(a){return a&&"body"!=a?"#"+a:"body"},getOverlay:function(c){var d=this.getSelector(c),e=a(d),f=e.find("> .pipas-overlay");return f.length||(f=b.defaultElement.clone().addClass("pipas-overlay"),e.append(f)),"body"!=e.selector&&f.css("zIndex",998),f},setReserved:function(b,c){var d=a.map(c,function(a){return[a]});b.attr("data-pipas-reserved",d.join(" "))}};this.show=function(a,c){c||(c="body");var d=b.getOverlay(c),e=b.parents[c]||{idList:{},elm:d};return e.idList[a]=a,b.parents[c]=e,d.show(),b.setReserved(d,e.idList),d},this.hide=function(a){for(var c in b.parents)if(b.parents.hasOwnProperty(c)&&b.parents[c].idList[a]){delete b.parents[c].idList[a],0==Object.keys(b.parents[c].idList).length?(b.parents[c].elm&&b.parents[c].elm.remove(),delete b.parents[c]):b.setReserved(b.parents[c].elm,b.parents[c].idList);break}},this.cancel=function(a){b.parents[a]&&(b.parents[a].elm.remove(),delete b.parents[a])},this.defaultElement=function(c){return void 0==c?b.defaultElement:(b.defaultElement="string"==typeof c?a(c):c,this)}}}(jQuery,pipas),function(a,b){b.overlay||console.error("Overlay must be declared before spinner",b),b.spinner=new function(){var c={defaultElement:a('<svg class="pipas-spinner-svg" viewBox="0 -256 1792 1792"><defs id="defs3033"/><g transform="matrix(1,0,0,-1,121.49153,1315.7966)" id="g3027"><path d="M 496,192 Q 496,132 453.5,90 411,48 352,48 q -60,0 -102,42 -42,42 -42,102 0,60 42,102 42,42 102,42 59,0 101.5,-42 Q 496,252 496,192 z M 928,0 Q 928,-53 890.5,-90.5 853,-128 800,-128 747,-128 709.5,-90.5 672,-53 672,0 672,53 709.5,90.5 747,128 800,128 853,128 890.5,90.5 928,53 928,0 z M 320,640 Q 320,574 273,527 226,480 160,480 94,480 47,527 0,574 0,640 q 0,66 47,113 47,47 113,47 66,0 113,-47 47,-47 47,-113 z M 1360,192 q 0,-46 -33,-79 -33,-33 -79,-33 -46,0 -79,33 -33,33 -33,79 0,46 33,79 33,33 79,33 46,0 79,-33 33,-33 33,-79 z M 528,1088 Q 528,1015 476.5,963.5 425,912 352,912 279,912 227.5,963.5 176,1015 176,1088 q 0,73 51.5,124.5 51.5,51.5 124.5,51.5 73,0 124.5,-51.5 Q 528,1161 528,1088 z m 464,192 q 0,-80 -56,-136 -56,-56 -136,-56 -80,0 -136,56 -56,56 -56,136 0,80 56,136 56,56 136,56 80,0 136,-56 56,-56 56,-136 z m 544,-640 q 0,-40 -28,-68 -28,-28 -68,-28 -40,0 -68,28 -28,28 -28,68 0,40 28,68 28,28 68,28 40,0 68,-28 28,-28 28,-68 z m -208,448 q 0,-33 -23.5,-56.5 -23.5,-23.5 -56.5,-23.5 -33,0 -56.5,23.5 -23.5,23.5 -23.5,56.5 0,33 23.5,56.5 23.5,23.5 56.5,23.5 33,0 56.5,-23.5 23.5,-23.5 23.5,-56.5 z" id="path3029" style="fill:currentColor"/> </g></svg>'),parents:{},getSelector:function(a){return a&&"body"!=a?"#"+a:"body"},createSpinner:function(b){var d=this.getSelector(b),e=a(d).css("position","relative"),f=e.find("> .pipas-spinner");return f.length||(f=a('<div class="pipas-spinner"></div>'),c.defaultElement.clone().appendTo(f),f.appendTo(e)),f},setReserved:function(b,c){var d=a.map(c,function(a){return[a]});b.attr("data-pipas-reserved",d.join(" "))}};this.show=function(a,d){d||(d="body");var e=c.createSpinner(d).show(),f=c.parents[d]||{idList:{},elm:e};f.idList[a]=a,c.parents[d]=f,b.overlay.show(a,d),"body"!=d&&e.css("zIndex",999),c.setReserved(e,f.idList)},this.hide=function(a){for(var d in c.parents)if(c.parents.hasOwnProperty(d)&&c.parents[d].idList[a]){delete c.parents[d].idList[a],0==Object.keys(c.parents[d].idList).length?(c.parents[d].elm&&c.parents[d].elm.remove(),delete c.parents[d]):c.setReserved(c.parents[d].elm,c.parents[d].idList);break}b.overlay.hide(a)},this.cancel=function(a){if(null==a)for(var d in c.parents)c.parents[d].elm.remove(),delete c.parents[d];c.parents[a]&&(c.parents[a].elm.remove(),delete c.parents[a]),b.overlay.cancel(a)},this.defaultElement=function(b){return void 0==b?c.defaultElement:(c.defaultElement="string"==typeof b?a(b):b,this)}}}(jQuery,pipas),function(a,b){b.overlay||console.error("Overlay must be declared before progress",b),b.ProgressControl=function(a,c){var d=0,e=100,f=0,g="&nbsp;",h=null;this.elm=c;var i=c.find(".bar");i.attr("value",0).attr("max",e),this.setValue=function(a){if(d=parseInt(a),isNaN(d)&&(d=0),f=e>0?Math.round(d/e*100):0,d>=0&&e>=0&&(i.stop(),h&&i.attr("value",h.value).attr("max",h.max),h={value:d,max:e},i.animate(h)),this.setLabel(),this.isSuccess()){for(var b in this.onSuccess){var c=this.onSuccess[b];c()}this.close()}return this},this.setMaximum=function(a){return e=parseInt(a?a:100),c.find(".bar").attr("max",e),this},this.setLabel=function(a){return g=a?a:g,this.elm.find(".label").html(g+" "+f+"%").show(),this},this.isSuccess=function(){return d>=e},this.onSuccess=[],this.close=function(){this.elm&&this.elm.remove(),b.overlay.hide(a)}},b.progress=new function(){var c={defaultElement:a('<div class="pipas-progress"><div class="wrapper"><div class="label">&nbsp;</div><progress class="bar" value="0" max="100"></progress></div></div>'),parents:{},getSelector:function(a){return a&&"body"!=a?"#"+a:"body"},createProgress:function(b){var d=this.getSelector(b),e=a(d).css("position","relative"),f=e.find("> .pipas-progress");return f.length||(f=c.defaultElement.clone(),f.appendTo(e)),f}};this.show=function(a){var d="progress-"+Math.round(1e4*Math.random());a||(a="body"),c.parents.hasOwnProperty(a)&&c.parents[a].close();var e=c.createProgress(a),f=new b.ProgressControl(d,e);return c.parents[a]=f,b.overlay.show(d,a),"body"!=a&&e.css("zIndex",999),f},this.cancel=function(a){if(null==a)for(var b in c.parents)c.parents[b].close(),delete c.parents[b];c.parents[a]&&(c.parents[a].close(),delete c.parents[a])}}}(jQuery,pipas),function(a,b,c){pipas.message=new function(){var d=this,e={getContainer:function(b){return"object"==typeof b?b:a(b?"#"+b:"body")},getElement:function(b,c){var d="",e=b.find("> .pipas-message");return c&&""!=c&&(d='<div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">'+c+"</h4></div>"),e.length||(e=a('<div class="modal pipas-message" role="dialog"><div class="modal-dialog modal-sm"><div class="modal-content">'+d+'<div class="modal-body"></div></div></div></div>'),b.append(e)),e},supported:["info","success","danger","warning"],show:function(f,g,h,i){"error"===g?g="danger":e.supported.indexOf(g)<0&&(g="info");var j=e.getContainer(h),k=e.getElement(j,i),l=k.find(".modal-body");c.show("message",h),0==l.find("> ."+g+"s").length&&l.append(a("<div class='message-group "+g+"s'></div>"));var m="danger"==g?"Error":g.charAt(0).toUpperCase()+g.slice(1),n=l.find("> ."+g+"s .alert span").filter(function(){return a(this).text()==f});n.length>0?n.each(function(){var b=a(this).parent(),c=b.find("span.badge");c.length>0?c.text(parseInt(c.text())+1):b.find("strong").after(' <span class="badge">2</span> ')}):l.find("> ."+g+"s").append(a("<div class='alert alert-"+g+"'><strong>"+m+"!</strong> <span>"+f+"</span></div>"));var o=a(b).height();l.height()>o&&l.height(o-150),k.is(":visible")||k.fadeIn();var p=function(){d.hide(h)};return a(".pipas-message").off("click",p).on("click",p),a(document).on("keydown",function(b){13==b.keyCode&&a(".pipas-message button").trigger("click")}),k}};this.showError=function(a,b,c){this.show(a,"danger",b,c)},this.showInfo=function(a,b,c){this.show(a,"info",b,c)},this.showSuccess=function(a,b,c){this.show(a,"success",b,c)},this.showWarning=function(a,b,c){this.show(a,"warning",b,c)},this.show=function(b,c,d,f){a.isArray(b)?a.each(b,function(a,b){e.show(b,c,d,f)}):e.show(b,c,d,f)},this.hide=function(a){var b=e.getContainer(a),d=e.getElement(b);c.hide("message"),d.remove()}}}(jQuery,window,pipas.overlay),function(a,b){b.progress||console.error("Progress must be declared before file upload",b),b.upload={text:{upload:"Upload",processing:"Processing"},onUpload:[],onSuccess:[],create:function(a,c){return new b.upload.UploadControl(a,c)},UploadControl:function(c,d){if(this.element=a(c),this.element.length>1)throw new Error("Passed selector is not unique. Found "+this.element.length+" similar elements.");this.onUpload=[],this.onSuccess=[];var e,f,g=this,h=function(){var a;for(a in g.onUpload)g.onUpload[a].call(this,g);for(a in b.upload.onUpload)b.upload.onUpload[a].call(this,g)},i=function(){var a,c=g.element[0];c.value=c.defaultValue;for(a in g.onSuccess)g.onSuccess[a].call(this,g);for(a in b.upload.onSuccess)b.upload.onSuccess[a].call(this,g)},j=function(){return g.processingStatusUrl?(f||(f=b.progress.show(g.progressContainerId),f.setLabel(b.upload.text.processing)),void a.ajax({type:"GET",url:g.processingStatusUrl,redirect:!1,spinner:!1,async:!0,success:function(a){"string"==typeof a?f.setValue(a):f.setValue(a.status),f.isSuccess()?i():setTimeout(function(){j()},300)}})):void i()};this.destroy=function(){this.element.off("change",k)};var k=function(){if(g.element.get(0).files.length>0){var c=new FormData;c.append("action","uploadImages");var f=0,i=g.element.attr("name")?g.element.attr("name").replace(/[[\]]/g,""):"photo";a.each(g.element,function(b,d){a.each(d.files,function(a,b){c.append(i+"["+f+"]",b),f++})});a.nette.ajax({redirect:!1,spinner:!1,url:d,type:"POST",async:!0,data:c,dataType:"json",cache:!1,contentType:!1,processData:!1,xhr:function(){var b=a.ajaxSettings.xhr();return b.upload&&b.upload.addEventListener("progress",function(a){a.lengthComputable&&e&&(e.setMaximum(a.total),e.setValue(a.loaded),e.isSuccess()&&(h(),j()))},!1),b},beforeSend:function(){e=b.progress.show(g.progressContainerId),e.setLabel(b.upload.text.upload)},success:function(){e&&e.close()},error:function(a,c,d){b.message.showError("Failed to upload files"),e&&e.close()}})}else console.log("No file selected")};this.element.off("change",k).on("change",k),this.processingStatusUrl=null;var l=this.element.closest(".modal").attr("id");this.progressContainerId=l?l+" .modal-dialog":"body"}}}(jQuery,pipas),function(a,b,c,d){b.modal=new function(){var b,e=this,f=function(a,b){return'<button type="button" class="btn btn-default" '+(b?'data-dismiss="modal"':"")+">"+a+"</button>"},g=function(){b&&(e.setBody(),e.setTitle(),e.hideSpinner(),e.setSizeMedium(),d.hide(e.id+"overlay"),b.remove()),b=null};this.id="modal-"+Math.round(1e4*Math.random()),this.text={close:"Close",refresh:"Refresh"},this.element=function(){return b||(b=a('<div class="modal fade" id="'+this.id+'" tabindex="-1" role="dialog" aria-labelledby="'+this.id+'-label"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><span class="modal-header-button close" data-dismiss="modal" aria-label="'+e.text.close+'"><span class="fa fa-close"></span></span><a href="#" class="modal-header-button refresh" title="'+e.text.refresh+'"><span class="fa fa-refresh"></span></a><h4 class="modal-title" id="'+this.id+'-label"></h4></div><div class="modal-body"></div><div class="modal-footer">'+f(e.text.close,!0)+"</div></div></div></div>"),a("body").append(b),b.on("hide.bs.modal",g)),b},this.getTitle=function(){return this.element().find(".modal-title").html()},this.setTitle=function(a){a=a?a.trim():"",this.element().find(".modal-title").html(a);var b=this.element().find(".modal-header");return a?b.show():b.hide(),this},this.getBody=function(){return this.element().find(".modal-body").html()},this.setBody=function(a){return this.element().find(".modal-body").html(a?a:""),this},this.getFooter=function(){return this.element().find(".modal-footer").html()},this.setFooter=function(a){return this.element().find(".modal-footer").html(a?a:""),this},this.setSizeSmall=function(){return this.element().find("> div").attr("class","modal-dialog modal-sm"),this},this.setSizeMedium=function(){return this.element().find("> div").attr("class","modal-dialog"),this},this.setSizeLarge=function(){return this.element().find("> div").attr("class","modal-dialog modal-lg"),this},this.show=function(){return this.element().modal({backdrop:!1,show:!0}),d.show(this.id+"overlay"),this},this.isVisible=function(){return this.element().is(":visible")},this.hide=function(){return g(),this},this.showSpinner=function(){return c.show(this.id,this.id+" .modal-dialog"),this.element().find(".pipas-overlay").css("border-radius","6px"),this},this.hideSpinner=function(){return c.hide(this.id),this},this.moveButtons=function(){var b=this.element(),c=b.find(".modal-footer");c.empty(),b.find(".modal-body form input[type='submit']").each(function(){var b=a(this).hide(),d=a(f(b.val()));d.addClass(b.attr("class")),c.append(d),d.off("click").on("click",function(){b.click()})}),c.append(f(e.text.close,!0))},this.setRefreshUrl=function(a){return a=a.replace(/.*?:\/\/[^\/]+/g,""),this.element().find(".modal-header .refresh").attr("href",a),this},this.getRefreshUrl=function(){return this.element().find(".modal-header .refresh").attr("href")},this.containsElement=function(b){return a(b).closest(".modal").length>0?!0:!1}}}(jQuery,pipas,pipas.spinner,pipas.overlay),function(a,b){b.bower=new function(){var a={directory:"bower_components"};this.directory=function(b){return void 0!=b&&(a.directory=b.replace(/^\/|\/$/g,"")),a.directory},this.get=function(c,d,e){b.getDependencies(b.applyBasePathForList(c,a.directory),d,e)}}}(jQuery,pipas),function(a,b){b.url={stateTypeName:"pipasAjax",cleanedParameters:["_fid"],history:[],clean:function(a){for(var b in this.cleanedParameters)a=this.remove(a,this.cleanedParameters[b]);return a},append:function(a,b,c){var d=this.separeParams(a);return d[b]=c,this.getPureUrl(a)+"?"+this.joinParams(d)},appendData:function(a,b){var c=this.separeParams(a),d=this.separeParams(decodeURI(b));for(var e in d)c[e]=d[e];return a=this.getPureUrl(a),0===Object.keys(c).length?a:a+"?"+this.joinParams(c)},search:function(a,b){if("string"==typeof a&&"string"==typeof b){var c=this.separeParams(a);for(var d in c)if(d===b)return c[d]}return null},remove:function(a,b){if("string"==typeof a&&"string"==typeof b){var c=this.separeParams(a);for(var d in c)d===b&&delete c[d];if(0===Object.keys(c).length)return this.getPureUrl(a);a=this.getPureUrl(a)+"?"+this.joinParams(c)}return a},changeTo:function(b){b=b?this.clean(b):"/";var c=this.history.pop();return c!==b&&this.history.push(c),this.history.push(b),a&&a.pushState?a.state&&a.state.url&&a.state.url===b?!1:(a.pushState({type:this.stateTypeName,url:b},null,b),!0):(console.error("Can not write URL"),!1)},searchFromData:function(a,b){if(a=decodeURI(a),"string"==typeof a&&"string"==typeof b){var c,d=a.split("&");for(var e in d)if(c=d[e].split("="),c[0]===b)return c[1]}return!1},getPureUrl:function(a){if("string"==typeof a){var b=a.split("?");return b[0]}return""},separeParams:function(a){var b=[];if("string"==typeof a){var c,d=a.split("?"),e=d[d.length-1],f=e.split("&"),g=0;for(var h in f)""!==f[h]&&(c=f[h].split("="),c[1]&&(-1!==c[0].indexOf("[]")&&(c[0]=c[0].substring(0,c[0].length-2)+"["+g+"]",g++),b[c[0]]=c[1]))}return b},joinParams:function(a){var b="";if(Array.isArray(a))for(var c in a)""!==b&&(b+="&"),b+=c+"="+a[c];return b},getCurrent:function(){return document.location.href}},a.state||a.replaceState({type:b.url.stateTypeName},null,document.location)}(history,pipas),function(a){a.utils={clone:function(a){return a?JSON.parse(JSON.stringify(a)):a}}}(pipas);